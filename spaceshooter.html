<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Anonymous Agents | Space Shooter</title>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: 'Courier New', monospace; touch-action: none; }
        
        #gameContainer { position: relative; width: 100vw; height: 100vh; background: #0a0e27; overflow: hidden; }
        
        #gameCanvas { display: block; background: linear-gradient(180deg, #0a0e27 0%, #1a1a3e 100%); }
        
        #ui { 
            position: absolute; top: env(safe-area-inset-top, 20px); left: 20px; 
            color: #00ffff; font-size: clamp(0.8rem, 3vw, 1.2rem); 
            text-shadow: 0 0 10px #00ffff; pointer-events: none; 
        }
        .ui-stat { margin-bottom: 5px; background: rgba(0,0,0,0.3); padding: 5px 10px; border-radius: 5px; display: inline-block; clear: both; float: left; }
        
        #startScreen, #gameOverScreen { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(10, 14, 39, 0.95); display: flex; 
            justify-content: center; align-items: center; z-index: 100; flex-direction: column;
            padding: 20px; box-sizing: border-box; text-align: center;
        }
        
        h1 { font-size: clamp(1.8rem, 8vw, 3.5rem); color: #00ffff; text-shadow: 0 0 30px #00ffff; margin-bottom: 1rem; letter-spacing: 3px; }
        p { color: #a29bfe; font-size: clamp(0.9rem, 2.5vw, 1.2rem); max-width: 500px; margin-bottom: 2rem; line-height: 1.6; }
        
        .play-btn { 
            background: linear-gradient(135deg, #00ffff, #0099cc); color: #0a0e27; border: none; 
            padding: 1rem 2.5rem; border-radius: 30px; font-weight: bold; 
            font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease; 
            letter-spacing: 2px; box-shadow: 0 0 20px rgba(0, 255, 255, 0.5); 
        }
        .play-btn:hover { transform: scale(1.1); box-shadow: 0 0 40px rgba(0, 255, 255, 0.8); }
        
        #gameOverScreen { background: rgba(0, 0, 0, 0.9); display: none; }
        #gameOverScreen h1 { color: #ff0055; text-shadow: 0 0 30px #ff0055; }
        #finalScore { color: #00ffff; font-size: 1.5rem; margin-bottom: 2rem; }
        
        #instructions { margin-top: 20px; color: #6e67da; font-size: 0.8rem; }

        /* Mobile Controls Overlay */
        #mobileControls {
            position: absolute; bottom: 30px; left: 0; width: 100%;
            display: none; justify-content: space-between; padding: 0 30px; box-sizing: border-box;
            pointer-events: none;
        }
        .control-area { 
            width: 80px; height: 80px; background: rgba(255,255,255,0.1); 
            border: 2px solid #00ffff; border-radius: 50%; pointer-events: auto;
            display: flex; justify-content: center; align-items: center; color: #00ffff;
            font-size: 1.5rem; -webkit-user-select: none;
        }

        @media (pointer: coarse) {
            #mobileControls { display: flex; }
            #instructions { display: none; }
        }
    </style>
</head>
<body>

    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <div id="ui">
            <div class="ui-stat" id="score">SCORE: 0</div><br>
            <div class="ui-stat" id="health">HEALTH: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div><br>
            <div class="ui-stat" id="level">LEVEL: 1</div>
        </div>
        
        <div id="startScreen">
            <h1>üöÄ SPACE SHOOTER</h1>
            <p>Destroy the asteroids and survive the cosmic storm!<br>Collect power-ups to repair your ship.</p>
            <button class="play-btn" onclick="startGame()">[ INITIALIZE ]</button>
            <div id="instructions">
                DESKTOP: ARROW KEYS to Move | SPACE to Shoot<br>
                MOBILE: Touch Left/Right Side to Move | Tap Center to Shoot
            </div>
        </div>
        
        <div id="gameOverScreen">
            <h1>MISSION FAILED</h1>
            <div id="finalScore"></div>
            <button class="play-btn" onclick="location.reload()">[ REBOOT SYSTEM ]</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            if(player) player.y = canvas.height - 70;
        }
        
        let gameActive = false;
        let score = 0;
        let health = 3;
        let level = 1;
        let waveCount = 0;
        
        const player = {
            x: window.innerWidth / 2,
            y: window.innerHeight - 70,
            width: 40,
            height: 40,
            speed: 7,
            velX: 0
        };
        
        let bullets = [];
        let asteroids = [];
        let particles = [];
        let powerUps = [];
        let stars = [];
        let lastWaveTime = 0;
        const keys = {};

        function initStars() {
            stars = [];
            for (let i = 0; i < 100; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2,
                    speed: Math.random() * 0.5 + 0.1
                });
            }
        }

        class Bullet {
            constructor(x, y) {
                this.x = x; this.y = y;
                this.speed = 10;
            }
            update() { this.y -= this.speed; }
            draw() {
                ctx.fillStyle = '#00ffff';
                ctx.shadowBlur = 10;
                ctx.shadowColor = '#00ffff';
                ctx.fillRect(this.x - 2, this.y, 4, 15);
                ctx.shadowBlur = 0;
            }
        }

        class Asteroid {
            constructor(x, y, size) {
                this.x = x; this.y = y;
                this.size = size;
                this.radius = size * 12;
                this.speed = (Math.random() * 2 + 1) + (level * 0.2);
                this.rotation = 0;
                this.rotSpeed = Math.random() * 0.05 - 0.025;
            }
            update() { 
                this.y += this.speed; 
                this.rotation += this.rotSpeed;
            }
            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                ctx.strokeStyle = '#a29bfe';
                ctx.lineWidth = 2;
                ctx.beginPath();
                // Simple jagged rock shape
                for(let i=0; i<8; i++) {
                    const angle = (i/8) * Math.PI * 2;
                    const r = this.radius * (0.8 + Math.random() * 0.4);
                    if(i===0) ctx.moveTo(r, 0);
                    else ctx.lineTo(Math.cos(angle)*r, Math.sin(angle)*r);
                }
                ctx.closePath();
                ctx.stroke();
                ctx.restore();
            }
        }

        function drawPlayer() {
            ctx.save();
            ctx.translate(player.x, player.y);
            
            // Ship Body
            ctx.fillStyle = '#00ffff';
            ctx.beginPath();
            ctx.moveTo(0, -20);
            ctx.lineTo(-15, 15);
            ctx.lineTo(15, 15);
            ctx.closePath();
            ctx.fill();
            
            // Thruster
            ctx.fillStyle = '#ff0055';
            const flame = 10 + Math.random() * 10;
            ctx.fillRect(-5, 15, 10, flame);
            
            ctx.restore();
        }

        function spawnAsteroids() {
            const count = Math.min(2 + level, 10);
            for (let i = 0; i < count; i++) {
                asteroids.push(new Asteroid(Math.random() * canvas.width, -50, Math.random() * 2 + 1));
            }
            lastWaveTime = Date.now();
        }

        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameOverScreen').style.display = 'none';
            score = 0; health = 3; level = 1; gameActive = true;
            bullets = []; asteroids = [];
            player.x = canvas.width / 2;
            initStars();
            spawnAsteroids();
            requestAnimationFrame(gameLoop);
        }

        function gameLoop() {
            if (!gameActive) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Background Stars
            ctx.fillStyle = '#fff';
            stars.forEach(s => {
                s.y += s.speed;
                if(s.y > canvas.height) s.y = 0;
                ctx.fillRect(s.x, s.y, s.size, s.size);
            });

            // Movement Logic (Mouse/Touch/Keys)
            if (keys['ArrowLeft'] || keys['a']) player.x -= player.speed;
            if (keys['ArrowRight'] || keys['d']) player.x += player.speed;
            
            // Boundary check
            if (player.x < 20) player.x = 20;
            if (player.x > canvas.width - 20) player.x = canvas.width - 20;

            drawPlayer();

            // Bullets
            bullets.forEach((b, i) => {
                b.update(); b.draw();
                if(b.y < 0) bullets.splice(i, 1);
            });

            // Asteroids
            asteroids.forEach((a, i) => {
                a.update(); a.draw();
                
                // Collision with bullet
                bullets.forEach((b, bi) => {
                    if(Math.hypot(a.x - b.x, a.y - b.y) < a.radius) {
                        score += 10;
                        asteroids.splice(i, 1);
                        bullets.splice(bi, 1);
                    }
                });

                // Collision with player
                if(Math.hypot(a.x - player.x, a.y - player.y) < a.radius + 15) {
                    health--;
                    asteroids.splice(i, 1);
                    if(health <= 0) {
                        gameActive = false;
                        document.getElementById('gameOverScreen').style.display = 'flex';
                        document.getElementById('finalScore').innerText = "SCORE: " + score;
                    }
                }

                if(a.y > canvas.height + 50) asteroids.splice(i, 1);
            });

            if(asteroids.length === 0 && Date.now() - lastWaveTime > 1000) {
                level++;
                spawnAsteroids();
            }

            // Update UI
            document.getElementById('score').innerText = `SCORE: ${score}`;
            document.getElementById('health').innerText = `HEALTH: ${'‚ù§Ô∏è'.repeat(health)}`;
            document.getElementById('level').innerText = `LEVEL: ${level}`;

            requestAnimationFrame(gameLoop);
        }

        // Input Handling
        window.addEventListener('keydown', e => { 
            keys[e.key] = true; 
            if(e.key === ' ') bullets.push(new Bullet(player.x, player.y - 20));
        });
        window.addEventListener('keyup', e => keys[e.key] = false);

        // Mobile Touch Handling
        window.addEventListener('touchstart', e => {
            const touchX = e.touches[0].clientX;
            const screenMid = window.innerWidth / 2;
            
            // Tap near center to shoot, sides to move
            if(touchX > screenMid - 50 && touchX < screenMid + 50) {
                bullets.push(new Bullet(player.x, player.y - 20));
            } else if (touchX < screenMid) {
                keys['ArrowLeft'] = true;
            } else {
                keys['ArrowRight'] = true;
            }
        });

        window.addEventListener('touchend', () => {
            keys['ArrowLeft'] = false;
            keys['ArrowRight'] = false;
        });

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

    </script>
</body>
</html>
